Необходимо построить три метрики для каждого пользователя.
- Фактор Recency измеряется по последнему заказу. Необходимо найти последний orders.order_ts по каждому user_id.
- Фактор Frequency оценивается по количеству заказов. Необходимо посчитать количество orders.order_id по каждому user_id.
- Фактор Monetary оценивается по потраченной сумме. Необходимо посчитать сумму значений orders.payment по каждому user_id.

Глубина данных - все данные, начиная с 2021-го года.

Расположение витрины данных, промежуточных таблиц и представлений, отображающих данные источника - схема analysis.

Все метрики должны быть построены на закрытых заказах, то есть, значение в поле status в таблице orders должно соответствовать значению в поле id в таблице orderstatuses, у которого key = 'Closed'. 

Дополнительно, при расчете каждой метрики потребуется соединение с таблицей users по полю id, чтобы при ранжировании учесть тех клиентов, у которых не было закрытых заказов. В таблице orders этому полю соответстует поле user_id.
